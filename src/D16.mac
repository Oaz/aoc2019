input:"59777098810822000809394624382157501556909810502346287077282177428724322323272236375412105805609092414782740710425184516236183547622345203164275191671720865872461284041797089470080366457723972985763645873208418782378044815481530554798953528896905275975178449123276858904407462285078456817038667669183420974001025093760473977009037844415364079145612611938513254763581971458140349825585640285658557835032882311363817855746737733934576748280568150394709654438729776867932430014255649458605325527757230466997043406136400716198065838842158274093116050506775489075879316061475634889155814030818530064869767243196343272137745926937355015378474209347100518533";

signal(s):=map(eval_string,charlist(s));

unit(n):=mod(abs(n),10);
m[i,j]:=[0,1,0,-1][1+floor(mod(i,4*j)/j)];
phasematrix[n]:=genmatrix(m,n,n);
phase(s):=map(unit,args(s.phasematrix[length(s)])[1]);
load(to_poly_solve);
compo(f,n):=compose_functions(makelist(f,i,1,n));
phases[n]:=compo(phase,n);
part1(s):=simplode(firstn(phases[100](signal(s)),8));
part1("80871224585914546619083218645595");
part1("19617804207202209144916044189917");
part1("69317163492948606335995924319873");
part1(input);

coefb[n]:=mod(binomial(99+n,n),10);
digit(l,o):=mod(lsum(l[mod(o+i,length(l))+1]*coefb[i],i,makelist(i,i,0,length(l)*10000-o)),10);
part2(s):=simplode(makelist(digit(signal(s),eval_string(substring(s,1,8))+i),i,0,7));
part2("03036732577212944063491565474664");
part2("02935109699940807407585447034323");
part2("03081770884921959731165446850517");
part2(input);
